<script setup>  import { ref, computed, onMounted, onUnmounted, inject } from "vue";  import FrequentlyAskedQuestions from "../homepage/FrequentlyAskedQuestions.vue";  import ContactSupportForm from "../homepage/ContactSupportForm.vue";  import Fuse from "fuse.js";  const selectedIndustry = ref(null);  const query = ref("");  const results = ref([]);  const showDropdown = ref(false);  const highlightedIndex = ref(-1); // Track highlighted item index  const emit = defineEmits(["updateProgress"]);  // Inject the global state  const globalCreationState = inject('globalCreationState');  const createMyLogoIsActive = inject('createMyLogoIsActive');  /* advance and back steps */  const advanceCreationStep = () => {    globalCreationState.creationStep += 1;    emit("updateProgress", 35);    console.log('Advancing to step:', globalCreationState.creationStep);  };  const previousCreationStep = () => {    if (globalCreationState.creationStep > 1) {      globalCreationState.creationStep -= 1;      emit("updateProgress", 0);      console.log('Going back to step:', globalCreationState.creationStep);    }  };  /* Industry Search Field Dropdown input field values */  // list all industries to show in the dropdown  const industries = [    { id: 1, name: "Electrical" },    { id: 2, name: "Plumbing" },    { id: 3, name: "Construction" },    { id: 4, name: "General Contractor" },    { id: 5, name: "Landscaping" },    { id: 6, name: "Painting and Decorating" },    { id: 7, name: "Roofing" },    { id: 8, name: "Structural Engineering" },    { id: 9, name: "Surveying" },  ];  // handle search fuse to match results  const fuse = new Fuse(industries, {    keys: ["name"],    threshold: 0.3,  });  // handle search  const search = () => {    results.value = query.value ? fuse.search(query.value) : [];  };  const selectItem = (item) => {    query.value = item.name;    selectedIndustry.value = item; // Set the selected item    showDropdown.value = false;  };  const hideDropdown = () => {    if (!industries.some(industry => industry.name.toLowerCase() === query.value.toLowerCase())) {      query.value = "";      selectedIndustry.value = null; // Clear selection if no match    }    setTimeout(() => {      showDropdown.value = false;    }, 100);  };  // Check if the input is in "focused" state for styling  const validIndustryInputValue = computed(() => showDropdown.value || query.value.trim() !== "");  // Check if a valid selection has been made  const isValidSelection = computed(() => !!selectedIndustry.value);  // Handle keyboard navigation for dropdown  const handleKeyDown = (event) => {    if (!showDropdown.value || results.value.length === 0) return;    if (event.key === "ArrowDown") {      // Move down in the list      highlightedIndex.value = (highlightedIndex.value + 1) % results.value.length;    } else if (event.key === "ArrowUp") {      // Move up in the list      highlightedIndex.value = (highlightedIndex.value - 1 + results.value.length) % results.value.length;    } else if (event.key === "Enter" && highlightedIndex.value >= 0) {      // Select the highlighted item on Enter key      selectItem(results.value[highlightedIndex.value].item);    }  };  // Add and remove event listeners for keydown  onMounted(() => {    globalCreationState.creationStep = 1;    window.addEventListener("keydown", handleKeyDown);  });  onUnmounted(() => {    window.removeEventListener("keydown", handleKeyDown);  });</script><template>  <section class="creation-step step-2 w-full relative block font-primary">    <div class="creation-flow-content w-full relative">    <!-- Top Prev/Next Buttons on Desktop -->    <div class="top-desktop-buttons relative flex-row justify-between hidden lg:flex pt-[66px] mx-auto w-[90%] site-container">      <!-- Previous step  -->      <button class="previous-step-button flex flex-row gap-[12px] py-[25px] px-[24px] max-w-fit border-[4px] border-black uppercase font-black text-[18px] leading-[2px] tracking-[1px] text-neutral-700 items-center h-[68px] transition transition-fast outline-none focus:outline-none"            @click="previousCreationStep">            <svg width="14" height="12" viewBox="0 0 14 12" fill="none" xmlns="http://www.w3.org/2000/svg">              <path fill-rule="evenodd" clip-rule="evenodd" d="M6.65829 11.4917C6.20268 11.9473 5.46399 11.9473 5.00838 11.4917L0.341709 6.82504C-0.113903 6.36943 -0.113903 5.63074 0.341709 5.17512L5.00838 0.508457C5.46399 0.052845 6.20268 0.052845 6.65829 0.508457C7.1139 0.964069 7.1139 1.70276 6.65829 2.15837L3.98325 4.83342L12.8333 4.83341C13.4777 4.83341 14 5.35575 14 6.00008C14 6.64441 13.4777 7.16675 12.8333 7.16675H3.98325L6.65829 9.84179C7.1139 10.2974 7.1139 11.0361 6.65829 11.4917Z" fill="#1F2937"/>            </svg>              Back One Step      </button>      <!-- Next step  -->      <button          class="next-step-button flex flex-row gap-[12px] py-[25px] px-[24px] max-w-fit uppercase font-black text-[18px] leading-[1] tracking-[2px] text-white bg-brand-200 items-center h-[68px] transition transition-fast outline-0 focus:outline-none"          :class="isValidSelection ? 'opacity-100 pointer-events-auto' : 'opacity-50 pointer-events-none'"          @click.prevent="advanceCreationStep">            Continue            <svg width="14" height="12" viewBox="0 0 14 12" fill="none" xmlns="http://www.w3.org/2000/svg">              <path fill-rule="evenodd" clip-rule="evenodd" d="M7.34171 0.508457C7.79732 0.0528452 8.53601 0.0528451 8.99162 0.508457L13.6583 5.17512C14.1139 5.63074 14.1139 6.36943 13.6583 6.82504L8.99162 11.4917C8.53601 11.9473 7.79732 11.9473 7.34171 11.4917C6.8861 11.0361 6.8861 10.2974 7.34171 9.84179L10.0168 7.16675L1.16667 7.16675C0.522335 7.16675 -2.81646e-08 6.64441 0 6.00008C2.81647e-08 5.35575 0.522335 4.83342 1.16667 4.83342H10.0168L7.34171 2.15837C6.8861 1.70276 6.8861 0.964069 7.34171 0.508457Z" fill="white"/>            </svg>      </button>    </div>    <!-- Step One Content -->    <div class="step-content site-container pt-[34px] lg:pt-[64px]">      <h1 class="block relative text-black font-bold text-[20px] md:text-[26px] lg:text-[32px] leading-[1.2]"> Select your industry</h1>      <h2 class="block relative text-black font-normal text-[18px] md:text-[20px] lg:text-[24px] pt-[20px] leading-[1.35]">        This will help create a more custom look for your industry.      </h2>      <!-- Industry Selection -->      <div class="search-industry relative w-full mt-[24px] md:mt-[35px] lg:mt-[50px]">        <div class="search-industry-input-field w-full relative block" :class="{ 'focused': validIndustryInputValue }">          <label for="search-industry" class="absolute top-[22px] left-[18px] text-[12px] text-black font-normal transition transition-fast">            Select Specialty (e.g., Plumbing, Electrical)          </label>          <input              type="text"              v-model="query"              @input="search"              @focus="showDropdown = true"              @blur="hideDropdown"              name="search-industry"              :class="{ 'focused': validIndustryInputValue }"              class="industry-search-input border-[3px] border-neutral-200 block w-full text-black font-medium min-h-[64px] max-h-[64px] px-[18px] transition transition-fast focus:border-brand-electric-blue active:border-brand-electric-blue"          />        </div>        <!-- Dropdown for search results -->        <ul v-if="showDropdown && results.length" class="dropdown-list absolute w-full border border-neutral-200 bg-white max-h-[200px] md:max-h-[290px] lg:max-h-[385px] overflow-y-auto z-10">          <li              v-for="(result, index) in results"              :key="result.item.id"              @mousedown.prevent="selectItem(result.item)"              :class="['dropdown-item text-black text-[16px] md:text-[18px] lg:text-[20px] font-medium lg:font-semibold py-[17px] px-[20px] lg:py-[12px] cursor-pointer transition transition-fast', { 'bg-neutral-100 text-brand-electric-blue': index === highlightedIndex }]"          >            {{ result.item.name }}          </li>        </ul>      </div>      <div class="bottom-button advance-button w-full relative flex flex-col justify-center items-center lg:hidden pt-[100px]">        <button            @click.prevent="advanceCreationStep"            class="bg-brand-200 text-white font-bold flex flex-row items-center justify-between uppercase gap-[12px] py-[16px] px-[17px] transition transition-fast"            :class="isValidSelection ? 'opacity-100 pointer-events-auto' : 'opacity-50 pointer-events-none'">              Continue              <svg width="14" height="12" viewBox="0 0 14 12" fill="none" xmlns="http://www.w3.org/2000/svg">            <path fill-rule="evenodd" clip-rule="evenodd" d="M7.34171 0.508457C7.79732 0.0528452 8.53601 0.0528451 8.99162 0.508457L13.6583 5.17512C14.1139 5.63074 14.1139 6.36943 13.6583 6.82504L8.99162 11.4917C8.53601 11.9473 7.79732 11.9473 7.34171 11.4917C6.8861 11.0361 6.8861 10.2974 7.34171 9.84179L10.0168 7.16675L1.16667 7.16675C0.522335 7.16675 -2.81646e-08 6.64441 0 6.00008C2.81647e-08 5.35575 0.522335 4.83342 1.16667 4.83342H10.0168L7.34171 2.15837C6.8861 1.70276 6.8861 0.964069 7.34171 0.508457Z" fill="white"/>          </svg>        </button>      </div>    </div>    </div>    <div class="bottom-content w-full relative lg:mt-[290px] hidden lg:block">      <frequently-asked-questions></frequently-asked-questions>      <contact-support-form></contact-support-form>    </div>  </section></template><style scoped lang="scss">  /* Optional styling for dropdown */  .dropdown-list {    @media only screen and (min-width: 1024px) {      box-shadow: 0 5px 12px 3px rgba(0,0,0, .10);    }  }  .dropdown-item:hover {    background-color: #e2e8f0; /* Replace with your brand color */  }  .industry-search-input {    transition: border-color 0.3s, box-shadow 0.3s; // Smooth transition for focus effect    &.focused {      padding-top: 32px;      padding-bottom: 17px;    }    &:focus,    &:active {      outline: none;      padding-top: 32px;      padding-bottom: 17px;    }  }  .search-industry-input-field {    position: relative;    &.focused label {      top: 10px; // Move label to the top when focused      transition: color 0.3s, top 0.3s;    }  }</style>